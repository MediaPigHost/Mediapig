define(function(n,i,t){!function(n){"use strict";function i(){var i={},t=Function;return{publish:function(){var t,c,a,l=arguments,r=i[l[0]];r&&(t=r.length,c=l.length>1?Array.prototype.splice.call(l,1):[],setTimeout(function(){for(a=0;t>a;a+=1)r[a].apply(n,c);r=n=c=null},0))},subscribe:function(n,c){if("string"!=typeof n)throw"invalid or missing channel";if(!(c instanceof t))throw"invalid or missing callback";return i[n]||(i[n]=[]),i[n].push(c),{channel:n,callback:c}},unsubscribe:function(n,c){if(n.channel&&n.callback&&(c=n.callback,n=n.channel),"string"!=typeof n)throw"invalid or missing channel";if(!(c instanceof t))throw"invalid or missing callback";var a,l=i[n],r=l instanceof Array?l.length:0;for(a=0;r>a;a+=1)if(l[a]===c){l.splice(a,1);break}}}}t.exports=i()}(this)});